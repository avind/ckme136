---
title: "Capstone Draft 1"
author: "Alex Vindua"
date: "May 13, 2015"
output: html_document
---

##Import 
```{r}
library(readr)
raw <- read_csv("C:/Users/Alex/1371_traffic_volumes.csv")
 ```

##Initial Cleaning
```{r}
library(magrittr)
library(dplyr)
raw <- tbl_df(raw) #conversion to tbl_df
raw2 <- raw[-1:-2,] #remove extraneous rows (French and blank row)

#rename columns
library(dplyr)
renamed.raw <- rename(raw2, "lhrs" = LHRS,"OS" =`O/S`, "year" = Year, "hwy.num" = `Hwy #`, "hwy.let" = `Hwy Let`, "hwy.type" = `Hwy Type (Text)`, "location" = `Location Description`, "reg" = Reg, "section.len" = `Section Length`, "conn.link.len" = `Connecting Link Length`, "sec.description" = `Secondary Description (for Connecting Links, Regional Boundarys,etc)`, "travel.pattern" = `Travel Pattern`, "dhv.percent" = `DHV %`, "directional.split" = `Directional Split`, "aadt" = AADT, "annual.aadt.change" = `Yearly % Change in AADT`, "decade.change" = `10 Year % Change in AADT`, "sadt" = SADT, "sawdt" = SAWDT, "wadt" = WADT)

#set proper data types 
renamed.raw[[9:11,13:20]] <- lapply(renamed.raw, function(x) as.numeric(renamed.raw[[9:11,13:20]])) #figure out issue here

#ugly manual solution
renamed.raw[[3]] <- as.factor(renamed.raw[[3]])
renamed.raw[[9]] <- as.numeric(renamed.raw[[9]])
renamed.raw[[10]] <- as.numeric(renamed.raw[[10]])
renamed.raw[[13]] <- as.numeric(renamed.raw[[13]])
renamed.raw[[14]] <- as.numeric(renamed.raw[[14]])
renamed.raw[[15]] <- as.numeric(renamed.raw[[15]])
renamed.raw[[16]] <- as.numeric(renamed.raw[[16]])
renamed.raw[[17]] <- as.numeric(renamed.raw[[17]])
renamed.raw[[18]] <- as.numeric(renamed.raw[[18]])
renamed.raw[[19]] <- as.numeric(renamed.raw[[19]])
renamed.raw[[20]] <- as.numeric(renamed.raw[[20]])
```

```{r}
#checking for NAs
length(renamed.raw$lhrs)
length(renamed.raw$year)
length(renamed.raw$aadt)
sum(is.na(renamed.raw$aadt))
sum(is.na(renamed.raw$sadt))
sum(is.na(renamed.raw$sawdt))
sum(is.na(renamed.raw$wadt))
sum(renamed.raw$year=="9999")
#there are 553 NA entries for aadt. year is also set to 9999 for these entries
```
There are 553 incomplete entries. These entries are set to Year "9999" and have no values for AADT and the related variables.

```{r}
#removing NAs and duplicate entries
library(dplyr)
library(magrittr)
fil.data <- renamed.raw %>%
  distinct() %>%
  filter(year!="9999")

length(fil.data$year)
length(fil.data$aadt)

```

There are `r length(fil.data$aadt)` remaining variables.

##
``` {r}
library(dplyr)
library(ggvis)

filter1 <- select(renamed.raw, lhrs, year, aadt)

renamed.raw %>%
  group_by(lhrs) %>%
  summarise(avg=mean(aadt)) %>%
  ggvis(~lhrs, ~avg) %>%
  layer_points()

#sort lhrs by geographic proximity to city?

```
##Exploratory

